model: EEGNet
is_training: true
random_seed: 2026
dataset: THU
n_fold: null
epochs: 400
weight_decay: 0.0001
patience: 20
early_stop_start_epoch: 50
use_gpu: true
train_mode: cross-subject
data_mix: true
class_weighted_ce: true
use_target_stream: false
dataset_root: E:/learning_projects/few-shot-learning_RSVP/Dataset
cosine_eta_min_factor: 0.01

# HyR-DPA framework switches (scaffold stage)
source_selection: All      # Options: All | Random | R-PCS | SimilarityOnly | DiscrimOnly (PCCS alias)
embedding_space: Euclidean # Options: Hyperbolic | Euclidean
psi_method: None           # Options: Tangent_Space | Time_Domain | None
training_mode: End2End     # Options: Decoupled | End2End
logit_adjustment: false
pseudo_refinement: false

# Source selection controls
source_selection_k: null
source_selection_min_score: null
source_selection_subjects: []
source_selection_scores: {}

# R-PCS controls (preferred) + PCCS legacy aliases
rpcs_positive_label: 1
rpcs_background_label: 0
rpcs_max_trials_per_class: 128
rpcs_min_trials_per_class: 4
rpcs_top_k: null
rpcs_mean_metric: riemann
rpcs_distance_metric: riemann
rpcs_mean_max_iter: 20
rpcs_mean_tol: 1.0e-6
rpcs_cov_eps: 1.0e-6
rpcs_cov_shrinkage: 0.0
rpcs_cov_estimator: sample      # sample | oas | lw
rpcs_use_correlation: true
rpcs_correlation_eps: 1.0e-12
rpcs_input_layout: channel_first # channel_first | time_first | auto
rpcs_plot_top_k: 10
rpcs_score_mode: rpcs
rpcs_score_eps: 1.0e-6
rpcs_target_use_all_trials: true
rpcs_target_max_trials: null
rpcs_target_bg_mode: amplitude  # amplitude | kurtosis | all
rpcs_target_bg_ratio: 0.7
rpcs_tau_d: null
rpcs_tau_s: null
rpcs_tau_d_percentile: 30.0
rpcs_tau_s_percentile: 70.0

# PCCS scaffold controls (legacy compatibility)
pccs_positive_label: 1
pccs_background_label: 0
pccs_max_trials_per_class: 128
pccs_min_trials_per_class: 4
pccs_top_k: null
pccs_mean_metric: riemann
pccs_distance_metric: riemann
pccs_mean_max_iter: 20
pccs_mean_tol: 1.0e-6
pccs_cov_eps: 1.0e-6
pccs_cov_shrinkage: 0.0
pccs_cov_estimator: sample
pccs_use_correlation: true
pccs_correlation_eps: 1.0e-12
pccs_input_layout: channel_first
pccs_plot_top_k: 10
pccs_score_mode: rpcs          # rpcs | similarity_only | discrim_only (used when source_selection=R-PCS/PCCS)
pccs_score_eps: 1.0e-6
pccs_target_use_all_trials: true
pccs_target_max_trials: null
pccs_target_bg_mode: amplitude
pccs_target_bg_ratio: 0.7
pccs_tau_d: null
pccs_tau_s: null
pccs_tau_d_percentile: 30.0
pccs_tau_s_percentile: 70.0

log_runtime: true
rt_deadline_ms: 200.0

datasets:
  THU:
    sub_num: 64
    n_channels: 62
    fs: 128
    n_class: 2
    batch_size: 32
  CAS:
    sub_num: 14
    n_channels: 62
    fs: 128
    n_class: 2
    batch_size: 32
  GIST:
    sub_num: 55
    n_channels: 32
    fs: 128
    n_class: 2
    batch_size: 32
  TCTR_1:
    sub_num: 15
    n_channels: 64
    fs: 128
    n_class: 2
    batch_size: 32
  TCTR_2:
    sub_num: 15
    n_channels: 64
    fs: 128
    n_class: 2
    batch_size: 32
  TCTR_A:
    sub_num: 15
    n_channels: 64
    fs: 128
    n_class: 2
    batch_size: 32
  TCTR_B:
    sub_num: 15
    n_channels: 64
    fs: 128
    n_class: 2
    batch_size: 32

models:
  DeepConvNet:
    learning_rate: 0.00005
    cosine_t_max: 400

  EEGNet:
    learning_rate: 0.001
    cosine_t_max: 400

  PLNet:
    learning_rate: 0.001
    cosine_t_max: 400

  EEGInception:
    learning_rate: 0.0001
    cosine_t_max: 400

  PPNN:
    learning_rate: 0.0001
    cosine_t_max: 400
